# local-kind

this is supposed to be run directly on your ubuntu-linux machine as the root user.

doing so will install several tools and manipulate your DNS resolver.

**this is a dirty hack script that won't clean-up changes done to your machine**

**so read the script and understand what it does to your machine**

please be aware of the following:
* lines 10-11 - will try to get the local IP address to bind kind and thus the k8s api to (see line 344) - make sure this works, else hard-code your local IP
* lines 37-51 - will change to your DNS setup to (maybe) workaround some issues - revert to your old setup manually, if you encounter problems
* lines 318-356 - you can play with additional settings for **cilium** - depending on the kernel you are running and the features you want

this script is **NOT** idempotent - so running this multiple times will be your own risk!

once the necessary files have been generated by `kind-cluster-setup.sh` - you can destroy and create clusters like this:

```bash
kind delete clusters local
kind create cluster --config /root/kind-cluster.yaml
mkdir /root/.kube
kind export kubeconfig --kubeconfig /root/.kube/config --name local
kubectl apply -f /root/cilium-1.14.4-direct-routing.yaml
sleep 120
kubectl apply -f /root/bgp-peering-policy.yaml -f /root/bgp-ippool.yaml -f /root/echoserver.yaml
```